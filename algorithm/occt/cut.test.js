import {
  unitRegularIcosahedronPolygons,
  unitRegularTetrahedronPolygons,
} from '@jsxcad/data-shape';

import { cut } from './cut.js';
import { fromPolygons } from './fromPolygons.js';
import { initOcct } from './occt.js';
import test from 'ava';
import { toGraph } from './toGraph.js';

test.beforeEach(async (t) => {
  await initOcct();
});

test('cut', (t) => {
  const aShape = fromPolygons(unitRegularIcosahedronPolygons);
  const bShape = fromPolygons(unitRegularTetrahedronPolygons);
  const cutShape = cut(aShape, bShape);
  const graph = toGraph(cutShape);
  t.deepEqual(graph,
{"edges":[{"loop":0,"next":1,"point":0,"twin":4},{"loop":0,"next":2,"point":1,"twin":21},{"loop":0,"next":3,"point":2,"twin":16},{"loop":0,"next":0,"point":3,"twin":7},{"loop":1,"next":5,"point":1,"twin":4},{"loop":1,"next":6,"point":0,"twin":15},{"loop":1,"next":4,"point":4,"twin":22},{"loop":2,"next":8,"point":0,"twin":7},{"loop":2,"next":9,"point":3,"twin":18},{"loop":2,"next":10,"point":5,"twin":27},{"loop":2,"next":11,"point":6,"twin":29},{"loop":2,"next":12,"point":7,"twin":32},{"loop":2,"next":13,"point":8,"twin":35},{"loop":2,"next":14,"point":9,"twin":41},{"loop":2,"next":15,"point":10,"twin":23},{"loop":2,"next":7,"point":4,"twin":15},{"loop":3,"next":17,"point":3,"twin":16},{"loop":3,"next":18,"point":2,"twin":25},{"loop":3,"next":16,"point":5,"twin":18},{"loop":4,"next":20,"point":1,"twin":39},{"loop":4,"next":21,"point":11,"twin":31},{"loop":4,"next":19,"point":2,"twin":21},{"loop":5,"next":23,"point":1,"twin":22},{"loop":5,"next":24,"point":4,"twin":23},{"loop":5,"next":22,"point":10,"twin":40},{"loop":6,"next":26,"point":5,"twin":25},{"loop":6,"next":27,"point":2,"twin":30},{"loop":6,"next":25,"point":6,"twin":27},{"loop":7,"next":29,"point":11,"twin":33},{"loop":7,"next":30,"point":7,"twin":29},{"loop":7,"next":31,"point":6,"twin":30},{"loop":7,"next":28,"point":2,"twin":31},{"loop":8,"next":33,"point":8,"twin":32},{"loop":8,"next":34,"point":7,"twin":33},{"loop":8,"next":32,"point":11,"twin":36},{"loop":9,"next":36,"point":9,"twin":35},{"loop":9,"next":37,"point":8,"twin":36},{"loop":9,"next":35,"point":11,"twin":38},{"loop":10,"next":39,"point":9,"twin":38},{"loop":10,"next":40,"point":11,"twin":39},{"loop":10,"next":41,"point":1,"twin":40},{"loop":10,"next":38,"point":10,"twin":41},{"loop":11,"next":43,"point":12,"twin":45},{"loop":11,"next":44,"point":13,"twin":52},{"loop":11,"next":42,"point":14,"twin":49},{"loop":12,"next":46,"point":13,"twin":45},{"loop":12,"next":47,"point":12,"twin":65},{"loop":12,"next":48,"point":15,"twin":61},{"loop":12,"next":45,"point":16,"twin":53},{"loop":13,"next":50,"point":12,"twin":49},{"loop":13,"next":51,"point":14,"twin":60},{"loop":13,"next":49,"point":17,"twin":69},{"loop":14,"next":53,"point":14,"twin":52},{"loop":14,"next":54,"point":13,"twin":53},{"loop":14,"next":55,"point":16,"twin":63},{"loop":14,"next":56,"point":18,"twin":73},{"loop":14,"next":57,"point":19,"twin":75},{"loop":14,"next":58,"point":20,"twin":78},{"loop":14,"next":59,"point":21,"twin":82},{"loop":14,"next":60,"point":22,"twin":70},{"loop":14,"next":52,"point":17,"twin":60},{"loop":15,"next":62,"point":16,"twin":61},{"loop":15,"next":63,"point":15,"twin":71},{"loop":15,"next":61,"point":18,"twin":63},{"loop":16,"next":65,"point":23,"twin":77},{"loop":16,"next":66,"point":15,"twin":65},{"loop":16,"next":64,"point":12,"twin":68},{"loop":17,"next":68,"point":22,"twin":81},{"loop":17,"next":69,"point":23,"twin":68},{"loop":17,"next":70,"point":12,"twin":69},{"loop":17,"next":67,"point":17,"twin":70},{"loop":18,"next":72,"point":18,"twin":71},{"loop":18,"next":73,"point":15,"twin":76},{"loop":18,"next":71,"point":19,"twin":73},{"loop":19,"next":75,"point":23,"twin":79},{"loop":19,"next":76,"point":20,"twin":75},{"loop":19,"next":77,"point":19,"twin":76},{"loop":19,"next":74,"point":15,"twin":77},{"loop":20,"next":79,"point":21,"twin":78},{"loop":20,"next":80,"point":20,"twin":79},{"loop":20,"next":78,"point":23,"twin":83},{"loop":21,"next":82,"point":23,"twin":81},{"loop":21,"next":83,"point":22,"twin":82},{"loop":21,"next":81,"point":21,"twin":83},{"loop":22,"next":85,"point":24,"twin":87},{"loop":22,"next":86,"point":25,"twin":99},{"loop":22,"next":84,"point":26,"twin":98},{"loop":23,"next":88,"point":25,"twin":87},{"loop":23,"next":89,"point":24,"twin":97},{"loop":23,"next":90,"point":27,"twin":106},{"loop":23,"next":91,"point":28,"twin":108},{"loop":23,"next":92,"point":29,"twin":111},{"loop":23,"next":93,"point":30,"twin":116},{"loop":23,"next":94,"point":31,"twin":119},{"loop":23,"next":95,"point":32,"twin":122},{"loop":23,"next":87,"point":33,"twin":100},{"loop":24,"next":97,"point":26,"twin":103},{"loop":24,"next":98,"point":27,"twin":97},{"loop":24,"next":96,"point":24,"twin":98},{"loop":25,"next":100,"point":26,"twin":99},{"loop":25,"next":101,"point":25,"twin":100},{"loop":25,"next":102,"point":33,"twin":121},{"loop":25,"next":99,"point":34,"twin":125},{"loop":26,"next":104,"point":27,"twin":103},{"loop":26,"next":105,"point":26,"twin":124},{"loop":26,"next":106,"point":35,"twin":109},{"loop":26,"next":103,"point":28,"twin":106},{"loop":27,"next":108,"point":35,"twin":112},{"loop":27,"next":109,"point":29,"twin":108},{"loop":27,"next":107,"point":28,"twin":109},{"loop":28,"next":111,"point":35,"twin":113},{"loop":28,"next":112,"point":30,"twin":111},{"loop":28,"next":110,"point":29,"twin":112},{"loop":29,"next":114,"point":30,"twin":113},{"loop":29,"next":115,"point":35,"twin":123},{"loop":29,"next":116,"point":34,"twin":117},{"loop":29,"next":113,"point":31,"twin":116},{"loop":30,"next":118,"point":31,"twin":117},{"loop":30,"next":119,"point":34,"twin":120},{"loop":30,"next":117,"point":32,"twin":119},{"loop":31,"next":121,"point":32,"twin":120},{"loop":31,"next":122,"point":34,"twin":121},{"loop":31,"next":120,"point":33,"twin":122},{"loop":32,"next":124,"point":34,"twin":123},{"loop":32,"next":125,"point":35,"twin":124},{"loop":32,"next":123,"point":26,"twin":125},{"loop":33,"next":127,"point":36,"twin":131},{"loop":33,"next":128,"point":37,"twin":137},{"loop":33,"next":126,"point":38,"twin":133},{"loop":34,"next":130,"point":36,"twin":145},{"loop":34,"next":131,"point":39,"twin":138},{"loop":34,"next":129,"point":37,"twin":131},{"loop":35,"next":133,"point":40,"twin":149},{"loop":35,"next":134,"point":36,"twin":133},{"loop":35,"next":135,"point":38,"twin":136},{"loop":35,"next":132,"point":41,"twin":152},{"loop":36,"next":137,"point":41,"twin":136},{"loop":36,"next":138,"point":38,"twin":137},{"loop":36,"next":139,"point":37,"twin":138},{"loop":36,"next":140,"point":39,"twin":148},{"loop":36,"next":141,"point":42,"twin":157},{"loop":36,"next":142,"point":43,"twin":160},{"loop":36,"next":143,"point":44,"twin":162},{"loop":36,"next":144,"point":45,"twin":165},{"loop":36,"next":136,"point":46,"twin":153},{"loop":37,"next":146,"point":39,"twin":145},{"loop":37,"next":147,"point":36,"twin":151},{"loop":37,"next":148,"point":47,"twin":155},{"loop":37,"next":145,"point":42,"twin":148},{"loop":38,"next":150,"point":36,"twin":149},{"loop":38,"next":151,"point":40,"twin":164},{"loop":38,"next":149,"point":47,"twin":151},{"loop":39,"next":153,"point":40,"twin":152},{"loop":39,"next":154,"point":41,"twin":153},{"loop":39,"next":152,"point":46,"twin":167},{"loop":40,"next":156,"point":42,"twin":155},{"loop":40,"next":157,"point":47,"twin":158},{"loop":40,"next":155,"point":43,"twin":157},{"loop":41,"next":159,"point":43,"twin":158},{"loop":41,"next":160,"point":47,"twin":163},{"loop":41,"next":158,"point":44,"twin":160},{"loop":42,"next":162,"point":40,"twin":166},{"loop":42,"next":163,"point":45,"twin":162},{"loop":42,"next":164,"point":44,"twin":163},{"loop":42,"next":161,"point":47,"twin":164},{"loop":43,"next":166,"point":46,"twin":165},{"loop":43,"next":167,"point":45,"twin":166},{"loop":43,"next":165,"point":40,"twin":167}],"faces":[{"holes":[],"loop":0},{"holes":[],"loop":1},{"holes":[],"loop":2},{"holes":[],"loop":3},{"holes":[],"loop":4},{"holes":[],"loop":5},{"holes":[],"loop":6},{"holes":[],"loop":7},{"holes":[],"loop":8},{"holes":[],"loop":9},{"holes":[],"loop":10},{"holes":[],"loop":11},{"holes":[],"loop":12},{"holes":[],"loop":13},{"holes":[],"loop":14},{"holes":[],"loop":15},{"holes":[],"loop":16},{"holes":[],"loop":17},{"holes":[],"loop":18},{"holes":[],"loop":19},{"holes":[],"loop":20},{"holes":[],"loop":21},{"holes":[],"loop":22},{"holes":[],"loop":23},{"holes":[],"loop":24},{"holes":[],"loop":25},{"holes":[],"loop":26},{"holes":[],"loop":27},{"holes":[],"loop":28},{"holes":[],"loop":29},{"holes":[],"loop":30},{"holes":[],"loop":31},{"holes":[],"loop":32},{"holes":[],"loop":33},{"holes":[],"loop":34},{"holes":[],"loop":35},{"holes":[],"loop":36},{"holes":[],"loop":37},{"holes":[],"loop":38},{"holes":[],"loop":39},{"holes":[],"loop":40},{"holes":[],"loop":41},{"holes":[],"loop":42},{"holes":[],"loop":43}],"loops":[{"edge":3,"face":0},{"edge":6,"face":1},{"edge":15,"face":2},{"edge":18,"face":3},{"edge":21,"face":4},{"edge":24,"face":5},{"edge":27,"face":6},{"edge":31,"face":7},{"edge":34,"face":8},{"edge":37,"face":9},{"edge":41,"face":10},{"edge":44,"face":11},{"edge":48,"face":12},{"edge":51,"face":13},{"edge":60,"face":14},{"edge":63,"face":15},{"edge":66,"face":16},{"edge":70,"face":17},{"edge":73,"face":18},{"edge":77,"face":19},{"edge":80,"face":20},{"edge":83,"face":21},{"edge":86,"face":22},{"edge":95,"face":23},{"edge":98,"face":24},{"edge":102,"face":25},{"edge":106,"face":26},{"edge":109,"face":27},{"edge":112,"face":28},{"edge":116,"face":29},{"edge":119,"face":30},{"edge":122,"face":31},{"edge":125,"face":32},{"edge":128,"face":33},{"edge":131,"face":34},{"edge":135,"face":35},{"edge":144,"face":36},{"edge":148,"face":37},{"edge":151,"face":38},{"edge":154,"face":39},{"edge":157,"face":40},{"edge":160,"face":41},{"edge":164,"face":42},{"edge":167,"face":43}],"points":[[-0.85065,0,-0.1493500000000001],[-0.85065,0,-0.52573],[-0.52573,-0.85065,0],[-0.6420381711144503,-0.5461518288855498,0.18818999999999986],[-0.7787676808323047,0.18818999999999997,-0.4094223191676953],[-0.40942231916769534,-0.7787676808323047,0.18818999999999994],[-0.14935000000000026,-0.85065,0],[0.18818999999999997,-0.6420381711144504,-0.5461518288855497],[0.18818999999999997,-0.40942231916769534,-0.7787676808323047],[0,-0.14934999999999987,-0.85065],[-0.5461518288855496,0.18819000000000005,-0.6420381711144505],[0,-0.52573,-0.85065],[-0.85065,0,0.52573],[-0.85065,0,0.14935000000000015],[-0.7787676808323047,-0.18818999999999997,0.4094223191676953],[-0.52573,0.85065,0],[-0.6420381711144503,0.5461518288855498,-0.18818999999999986],[-0.5461518288855496,-0.18819000000000002,0.6420381711144504],[-0.4094223191676954,0.7787676808323047,-0.18818999999999986],[-0.1493500000000001,0.85065,0],[0.18818999999999997,0.6420381711144504,0.5461518288855497],[0.18818999999999997,0.40942231916769534,0.7787676808323047],[0,0.14934999999999987,0.85065],[0,0.52573,0.85065],[-0.18819000000000008,-0.4094223191676953,0.7787676808323047],[-0.18819000000000008,-0.6420381711144505,0.5461518288855496],[0,-0.52573,0.85065],[0,-0.14934999999999976,0.85065],[0.5461518288855496,0.18819000000000002,0.6420381711144504],[0.7787676808323047,0.18818999999999997,0.4094223191676953],[0.85065,0,0.1493500000000001],[0.6420381711144504,-0.5461518288855497,-0.18818999999999997],[0.40942231916769534,-0.7787676808323047,-0.18818999999999994],[0.1493500000000001,-0.85065,0],[0.52573,-0.85065,0],[0.85065,0,0.52573],[0.85065,0,-0.52573],[0.7787676808323047,-0.18818999999999997,-0.4094223191676953],[0.5461518288855496,-0.18819000000000002,-0.6420381711144504],[0.85065,0,-0.14935000000000004],[0,0.52573,-0.85065],[0,0.14934999999999976,-0.85065],[0.6420381711144504,0.5461518288855497,0.18818999999999997],[0.40942231916769534,0.7787676808323047,0.18818999999999994],[0.14935000000000004,0.85065,0],[-0.18819000000000008,0.6420381711144505,-0.5461518288855496],[-0.18819000000000008,0.4094223191676953,-0.7787676808323047],[0.52573,0.85065,0]]}
);
});
