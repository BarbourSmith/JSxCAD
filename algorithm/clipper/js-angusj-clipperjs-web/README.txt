Extracted from https://github.com/xaviergonz/js-angusj-clipper due to missing 'document' workaround.
